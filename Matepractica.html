<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MatePr√°ctica - Repaso de Matem√°ticas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f0f4fa;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .app-container {
            max-width: 1200px;
            width: 100%;
            background-color: #ffffffc0;
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        h1 {
            color: #6b7a8f;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 300;
            font-size: 2.5em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            background-color: #d9e3f0;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 500;
            color: #5b6c7e;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border: 1px solid #c5d5e6;
        }

        .tab-button:hover {
            background-color: #cbd8e9;
            transform: translateY(-2px);
        }

        .tab-button.active {
            background-color: #b7cee8;
            color: #3e4f62;
            border-color: #9bb6d1;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }

        .tab-panel {
            display: none;
            background-color: #f8faff;
            border-radius: 25px;
            padding: 25px;
            border: 1px solid #e0eaf5;
        }

        .tab-panel.active {
            display: block;
        }

        .config-panel {
            background-color: #e6eefa;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }

        .config-item {
            flex: 1 1 180px;
        }

        .config-item label {
            display: block;
            margin-bottom: 8px;
            color: #5a6a7c;
            font-weight: 500;
            font-size: 0.95em;
        }

        select, input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            border-radius: 50px;
            border: 1px solid #cbd6e4;
            background-color: #ffffff;
            font-size: 1em;
            color: #2c3e50;
            outline: none;
            transition: border 0.3s;
        }

        select:focus, input[type="number"]:focus {
            border-color: #9bb7d4;
        }

        button {
            background-color: #c4d4e8;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 500;
            color: #3b4b5c;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #b0c4db;
            box-shadow: 0 4px 6px rgba(0,0,0,0.03);
            min-width: 140px;
        }

        button:hover {
            background-color: #b6cae0;
            transform: scale(0.98);
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
            justify-content: center;
            align-items: center;
        }

        .numero-ejercicios {
            display: flex;
            align-items: center;
            gap: 15px;
            background-color: #e6eefa;
            padding: 10px 20px;
            border-radius: 50px;
        }

        .numero-ejercicios input {
            width: 80px;
            text-align: center;
        }

        .practice-area {
            background-color: #ffffff;
            border-radius: 20px;
            padding: 20px;
            min-height: 300px;
            border: 1px dashed #c1d3e8;
        }

        .operations-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .operation-item {
            background-color: #f0f6ff;
            border-radius: 18px;
            padding: 20px;
            text-align: center;
            font-size: 1.4em;
            font-family: 'Courier New', monospace;
            border: 1px solid #d4e2f2;
            box-shadow: 0 4px 8px rgba(0,0,0,0.02);
        }

        .solution-input {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .solution-input input {
            width: 100px;
            padding: 8px 12px;
            border-radius: 50px;
            border: 1px solid #cbd6e4;
            text-align: center;
        }

        .solution-input button {
            padding: 8px 20px;
            min-width: auto;
            background-color: #b8d3e8;
        }

        .solution-result {
            margin-top: 10px;
            font-size: 0.8em;
            min-height: 24px;
        }

        .correcto {
            color: #5b8c5a;
        }
        .incorrecto {
            color: #c55a5a;
        }

        .print-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding: 20px;
            border-top: 2px solid #e0eaf5;
        }

        .print-buttons button {
            background-color: #b7cee8;
            padding: 15px 30px;
            font-size: 1.1em;
        }

        .codigo-ejercicios {
            text-align: center;
            margin: 15px 0;
            font-size: 1.2em;
            color: #6b7a8f;
        }
    </style>
</head>
<body>
<div class="app-container">
    <h1>üìê MatePr√°ctica ¬∑ Matem√°ticas</h1>

    <!-- Pesta√±as -->
    <div class="tabs">
        <button class="tab-button active" data-tab="suma">‚ûï Suma</button>
        <button class="tab-button" data-tab="resta">‚ûñ Resta</button>
        <button class="tab-button" data-tab="multiplicacion">‚úñÔ∏è Multiplicaci√≥n</button>
        <button class="tab-button" data-tab="division">‚ûó Divisi√≥n</button>
    </div>

    <!-- Panel Suma -->
    <div id="suma" class="tab-panel active">
        <div class="config-panel">
            <div class="config-item">
                <label>Cifras sumandos:</label>
                <select id="suma-cifras">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                    <option value="4">4 cifras</option>
                    <option value="5">5 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>N¬∫ sumandos:</label>
                <select id="suma-sumandos">
                    <option value="2">2 sumandos</option>
                    <option value="3">3 sumandos</option>
                    <option value="4">4 sumandos</option>
                </select>
            </div>
            <div class="config-item">
                <label>Decimales:</label>
                <select id="suma-decimales">
                    <option value="0">0 decimales</option>
                    <option value="1">1 decimal</option>
                    <option value="2">2 decimales</option>
                    <option value="3">3 decimales</option>
                </select>
            </div>
        </div>
        <div class="action-buttons">
            <div class="numero-ejercicios">
                <label>Ejercicios:</label>
                <input type="number" id="suma-num-ej" min="1" max="50" value="10">
            </div>
            <button class="generar-practica" data-tipo="suma">üìù Generar pr√°ctica</button>
        </div>
        <div id="suma-practice" class="practice-area"></div>
    </div>

    <!-- Panel Resta -->
    <div id="resta" class="tab-panel">
        <div class="config-panel">
            <div class="config-item">
                <label>Cifras:</label>
                <select id="resta-cifras">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                    <option value="4">4 cifras</option>
                    <option value="5">5 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>N¬∫ operandos:</label>
                <select id="resta-sumandos">
                    <option value="2">2 operandos</option>
                    <option value="3">3 operandos</option>
                    <option value="4">4 operandos</option>
                </select>
            </div>
            <div class="config-item">
                <label>Decimales:</label>
                <select id="resta-decimales">
                    <option value="0">0 decimales</option>
                    <option value="1">1 decimal</option>
                    <option value="2">2 decimales</option>
                    <option value="3">3 decimales</option>
                </select>
            </div>
        </div>
        <div class="action-buttons">
            <div class="numero-ejercicios">
                <label>Ejercicios:</label>
                <input type="number" id="resta-num-ej" min="1" max="50" value="10">
            </div>
            <button class="generar-practica" data-tipo="resta">üìù Generar pr√°ctica</button>
        </div>
        <div id="resta-practice" class="practice-area"></div>
    </div>

    <!-- Panel Multiplicaci√≥n -->
    <div id="multiplicacion" class="tab-panel">
        <div class="config-panel">
            <div class="config-item">
                <label>Cifras multiplicando:</label>
                <select id="multiplicacion-cifras1">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                    <option value="4">4 cifras</option>
                    <option value="5">5 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>Cifras multiplicador:</label>
                <select id="multiplicacion-cifras2">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                    <option value="4">4 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>Decimales en:</label>
                <select id="multiplicacion-decimales">
                    <option value="0">Ninguno</option>
                    <option value="1">Multiplicando</option>
                    <option value="2">Multiplicador</option>
                    <option value="3">Ambos</option>
                </select>
            </div>
            <div class="config-item">
                <label>N¬∫ decimales:</label>
                <select id="multiplicacion-cantDecimales">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>
            </div>
        </div>
        <div class="action-buttons">
            <div class="numero-ejercicios">
                <label>Ejercicios:</label>
                <input type="number" id="multiplicacion-num-ej" min="1" max="50" value="10">
            </div>
            <button class="generar-practica" data-tipo="multiplicacion">üìù Generar pr√°ctica</button>
        </div>
        <div id="multiplicacion-practice" class="practice-area"></div>
    </div>

    <!-- Panel Divisi√≥n (CORREGIDO: con opci√≥n decimales en dividendo/divisor/ambos) -->
    <div id="division" class="tab-panel">
        <div class="config-panel">
            <div class="config-item">
                <label>Cifras dividendo:</label>
                <select id="division-cifrasD">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                    <option value="4">4 cifras</option>
                    <option value="5">5 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>Cifras divisor:</label>
                <select id="division-cifrasd">
                    <option value="1">1 cifra</option>
                    <option value="2" selected>2 cifras</option>
                    <option value="3">3 cifras</option>
                </select>
            </div>
            <div class="config-item">
                <label>Decimales en:</label>
                <select id="division-decimalesOpc">
                    <option value="0">Ninguno</option>
                    <option value="1">Dividendo</option>
                    <option value="2">Divisor</option>
                    <option value="3">Ambos</option>
                </select>
            </div>
            <div class="config-item">
                <label>N¬∫ decimales:</label>
                <select id="division-cantDecimales">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>
        </div>
        <div class="action-buttons">
            <div class="numero-ejercicios">
                <label>Ejercicios:</label>
                <input type="number" id="division-num-ej" min="1" max="50" value="10">
            </div>
            <button class="generar-practica" data-tipo="division">üìù Generar pr√°ctica</button>
        </div>
        <div id="division-practice" class="practice-area"></div>
    </div>
</div>

<script>
    // Navegaci√≥n pesta√±as
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById(btn.dataset.tab).classList.add('active');
        });
    });

    // Generar n√∫mero aleatorio con decimales espec√≠ficos
    function generarNumero(cifras, decimales) {
        let num = Math.floor(Math.random() * (Math.pow(10, cifras) - 1)) + 1;
        if (decimales > 0) {
            let decimalPart = Math.floor(Math.random() * Math.pow(10, decimales));
            num = parseFloat(`${num}.${decimalPart.toString().padStart(decimales, '0')}`);
        }
        return num;
    }

    // Generar divisi√≥n exacta con decimales en dividendo/divisor/ambos
    function generarDivisionExacta(cifrasD, cifrasd, decimalesOpc, cantDecimales) {
        // Generar divisor (si tiene decimales, ser√° un n√∫mero decimal)
        let divisorBase = Math.floor(Math.random() * (Math.pow(10, cifrasd) - 1)) + 1;
        let divisor = divisorBase;
        
        // Generar dividendo base (entero)
        let dividendoBase = Math.floor(Math.random() * (Math.pow(10, cifrasD) - 1)) + 1;
        let dividendo = dividendoBase;
        
        // Aplicar decimales seg√∫n la opci√≥n seleccionada
        if (decimalesOpc === 1 || decimalesOpc === 3) { // Decimales en dividendo o ambos
            let decimalPart = Math.floor(Math.random() * Math.pow(10, cantDecimales));
            dividendo = parseFloat(`${dividendoBase}.${decimalPart.toString().padStart(cantDecimales, '0')}`);
        }
        
        if (decimalesOpc === 2 || decimalesOpc === 3) { // Decimales en divisor o ambos
            let decimalPart = Math.floor(Math.random() * Math.pow(10, cantDecimales));
            divisor = parseFloat(`${divisorBase}.${decimalPart.toString().padStart(cantDecimales, '0')}`);
        }
        
        // Ahora necesitamos que dividendo / divisor sea exacto
        // Para ello, multiplicamos ambos por 10^cantDecimales para trabajar con enteros
        let factor = Math.pow(10, cantDecimales);
        let dividendoEntero = Math.round(dividendo * factor);
        let divisorEntero = Math.round(divisor * factor);
        
        // Buscamos un cociente que sea entero
        let cocienteEntero = Math.floor(dividendoEntero / divisorEntero);
        if (cocienteEntero === 0) cocienteEntero = 1;
        
        // Recalculamos dividendo para que sea exacto
        dividendoEntero = divisorEntero * cocienteEntero;
        
        // Convertimos de vuelta a decimales
        dividendo = dividendoEntero / factor;
        
        // Asegurar que el dividendo tenga las cifras adecuadas
        let maxDividendo = Math.pow(10, cifrasD) - 1;
        let minDividendo = Math.pow(10, cifrasD - 1);
        
        if (dividendo > maxDividendo) {
            // Reducimos el cociente
            cocienteEntero = Math.floor(maxDividendo * factor / divisorEntero);
            dividendoEntero = divisorEntero * cocienteEntero;
            dividendo = dividendoEntero / factor;
        }
        if (dividendo < minDividendo && cifrasD > 1) {
            // Aumentamos el cociente
            cocienteEntero = Math.ceil(minDividendo * factor / divisorEntero);
            dividendoEntero = divisorEntero * cocienteEntero;
            dividendo = dividendoEntero / factor;
        }
        
        let cociente = dividendo / divisor;
        
        return { dividendo, divisor, cociente };
    }

    // Generar operandos seg√∫n tipo
    function generarOperandos(tipo, config) {
        let ops = [];
        if (tipo === 'suma' || tipo === 'resta') {
            let cifras = parseInt(config.cifras);
            let numOps = parseInt(config.sumandos);
            let decimales = parseInt(config.decimales);
            for (let i = 0; i < numOps; i++) ops.push(generarNumero(cifras, decimales));
        } else if (tipo === 'multiplicacion') {
            let cifras1 = parseInt(config.cifras1);
            let cifras2 = parseInt(config.cifras2);
            let decimalesOpc = parseInt(config.decimales);
            let cantDec = parseInt(config.cantDecimales);
            
            let mult1 = generarNumero(cifras1, (decimalesOpc === 1 || decimalesOpc === 3) ? cantDec : 0);
            let mult2 = generarNumero(cifras2, (decimalesOpc === 2 || decimalesOpc === 3) ? cantDec : 0);
            ops = [mult1, mult2];
        } else if (tipo === 'division') {
            let cifrasD = parseInt(config.cifrasD);
            let cifrasd = parseInt(config.cifrasd);
            let decimalesOpc = parseInt(config.decimalesOpc);
            let cantDecimales = parseInt(config.cantDecimales);
            let division = generarDivisionExacta(cifrasD, cifrasd, decimalesOpc, cantDecimales);
            ops = [division.dividendo, division.divisor, division.cociente];
        }
        return ops;
    }

    // Calcular resultado
    function calcularResultado(tipo, ops) {
        if (tipo === 'suma') return ops.reduce((a,b) => a + b, 0);
        if (tipo === 'resta') return ops.reduce((a,b) => a - b);
        if (tipo === 'multiplicacion') return ops[0] * ops[1];
        if (tipo === 'division') return ops[2];
        return 0;
    }

    // Formatear operaci√≥n para mostrar
    function formatearOperacion(tipo, ops) {
        if (tipo === 'suma') return ops.join(' + ') + ' =';
        if (tipo === 'resta') return ops.join(' - ') + ' =';
        if (tipo === 'multiplicacion') return ops.join(' √ó ') + ' =';
        if (tipo === 'division') return ops[0] + ' √∑ ' + ops[1] + ' =';
    }

    // Variable global para almacenar los ejercicios actuales
    let ejerciciosActuales = {
        tipo: '',
        ejercicios: [],
        codigo: '',
        config: {}
    };

    // Generar pr√°ctica
    document.querySelectorAll('.generar-practica').forEach(btn => {
        btn.addEventListener('click', (e) => {
            let tipo = e.target.dataset.tipo;
            let numEjercicios = parseInt(document.getElementById(tipo + '-num-ej').value) || 10;
            
            // Recoger config seg√∫n el tipo
            let config = {};
            if (tipo === 'suma') {
                config = { 
                    cifras: document.getElementById('suma-cifras').value, 
                    sumandos: document.getElementById('suma-sumandos').value, 
                    decimales: document.getElementById('suma-decimales').value 
                };
            } else if (tipo === 'resta') {
                config = { 
                    cifras: document.getElementById('resta-cifras').value, 
                    sumandos: document.getElementById('resta-sumandos').value, 
                    decimales: document.getElementById('resta-decimales').value 
                };
            } else if (tipo === 'multiplicacion') {
                config = { 
                    cifras1: document.getElementById('multiplicacion-cifras1').value, 
                    cifras2: document.getElementById('multiplicacion-cifras2').value, 
                    decimales: document.getElementById('multiplicacion-decimales').value,
                    cantDecimales: document.getElementById('multiplicacion-cantDecimales').value 
                };
            } else if (tipo === 'division') {
                config = { 
                    cifrasD: document.getElementById('division-cifrasD').value, 
                    cifrasd: document.getElementById('division-cifrasd').value, 
                    decimalesOpc: document.getElementById('division-decimalesOpc').value,
                    cantDecimales: document.getElementById('division-cantDecimales').value 
                };
            }

            // Generar ejercicios
            ejerciciosActuales.tipo = tipo;
            ejerciciosActuales.config = config;
            ejerciciosActuales.ejercicios = [];
            ejerciciosActuales.codigo = Math.random().toString(36).substring(2, 8).toUpperCase();

            for (let i = 0; i < numEjercicios; i++) {
                let ops = generarOperandos(tipo, config);
                let resultado = calcularResultado(tipo, ops);
                ejerciciosActuales.ejercicios.push({ ops, resultado });
            }

            // Mostrar ejercicios en pantalla
            mostrarEjerciciosEnPantalla(tipo);
        });
    });

    function mostrarEjerciciosEnPantalla(tipo) {
        const container = document.getElementById(tipo + '-practice');
        container.innerHTML = '';
        
        // Mostrar c√≥digo
        const codigoDiv = document.createElement('div');
        codigoDiv.className = 'codigo-ejercicios';
        codigoDiv.innerHTML = `üìã C√≥digo de pr√°ctica: <strong>${ejerciciosActuales.codigo}</strong>`;
        container.appendChild(codigoDiv);

        // Grid de ejercicios
        const grid = document.createElement('div');
        grid.className = 'operations-grid';
        
        ejerciciosActuales.ejercicios.forEach((ej, index) => {
            const item = document.createElement('div');
            item.className = 'operation-item';
            item.innerHTML = `
                <div style="font-size: 0.8em; color: #8a9bb0; margin-bottom: 5px;">Ej. ${index + 1}</div>
                <div>${formatearOperacion(tipo, ej.ops)}</div>
                <div class="solution-input">
                    <input type="number" step="any" id="sol-${tipo}-${index}" placeholder="?">
                    <button class="check-sol" data-tipo="${tipo}" data-index="${index}" data-correcto="${ej.resultado}">Comprobar</button>
                </div>
                <div class="solution-result" id="res-${tipo}-${index}"></div>
            `;
            grid.appendChild(item);
        });

        container.appendChild(grid);

        // Botones de impresi√≥n
        const printDiv = document.createElement('div');
        printDiv.className = 'print-buttons';
        printDiv.innerHTML = `
            <button id="imprimir-ficha">üñ®Ô∏è IMPRIMIR FICHA</button>
            <button id="imprimir-soluciones">üîç IMPRIMIR SOLUCIONES</button>
        `;
        container.appendChild(printDiv);

        // Event listeners para comprobaci√≥n
        document.querySelectorAll('.check-sol').forEach(btn => {
            btn.addEventListener('click', (e) => {
                let index = e.target.dataset.index;
                let tipoOp = e.target.dataset.tipo;
                let correcto = parseFloat(e.target.dataset.correcto);
                let input = document.getElementById(`sol-${tipoOp}-${index}`);
                let resDiv = document.getElementById(`res-${tipoOp}-${index}`);
                let valor = parseFloat(input.value);
                if (Math.abs(valor - correcto) < 0.0001) {
                    resDiv.innerHTML = '<span class="correcto">‚úì Correcto</span>';
                } else {
                    resDiv.innerHTML = `<span class="incorrecto">‚úó Incorrecto. Respuesta: ${correcto.toFixed(4)}</span>`;
                }
            });
        });

        // Event listeners para impresi√≥n
        document.getElementById('imprimir-ficha').addEventListener('click', imprimirFicha);
        document.getElementById('imprimir-soluciones').addEventListener('click', imprimirSoluciones);
    }

    function imprimirFicha() {
        const { tipo, ejercicios, codigo } = ejerciciosActuales;
        
        let contenido = `
            <html>
            <head>
                <title>Ficha ${tipo} - C√≥digo ${codigo}</title>
                <style>
                    @page {
                        size: A4;
                        margin: 1.5cm;
                    }
                    body {
                        font-family: 'Courier New', monospace;
                        background: white;
                        margin: 0;
                        padding: 20px;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        color: #333;
                    }
                    .codigo {
                        font-size: 14px;
                        color: #666;
                        margin-top: 5px;
                    }
                    .tabla-ejercicios {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        page-break-inside: avoid;
                    }
                    .pagina {
                        page-break-after: always;
                        margin-bottom: 30px;
                    }
                    .ejercicio {
                        border: 2px solid #000;
                        padding: 25px 10px;
                        text-align: center;
                        font-size: 20px;
                        background: white;
                        position: relative;
                        min-height: 100px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }
                    .ejercicio::after {
                        content: '';
                        position: absolute;
                        bottom: 10px;
                        left: 10%;
                        width: 80%;
                        height: 2px;
                        background-color: #000;
                    }
                    .numero-ej {
                        position: absolute;
                        top: 5px;
                        left: 5px;
                        font-size: 12px;
                        color: #666;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 20px;
                        font-size: 12px;
                        color: #666;
                    }
                    @media print {
                        .ejercicio {
                            border: 2px solid black;
                            page-break-inside: avoid;
                        }
                    }
                </style>
            </head>
            <body>
        `;

        let ejerciciosPorPagina = 10;
        for (let p = 0; p < Math.ceil(ejercicios.length / ejerciciosPorPagina); p++) {
            contenido += `<div class="pagina">`;
            contenido += `<div class="header">`;
            contenido += `<h2>‚úèÔ∏è Ficha de ${tipo}</h2>`;
            contenido += `<div class="codigo">C√≥digo: ${codigo} | P√°gina ${p+1}</div>`;
            contenido += `</div>`;
            
            contenido += `<div class="tabla-ejercicios">`;
            for (let i = p * ejerciciosPorPagina; i < Math.min((p + 1) * ejerciciosPorPagina, ejercicios.length); i++) {
                let ej = ejercicios[i];
                let opStr = '';
                if (tipo === 'suma') opStr = ej.ops.join(' + ') + ' = ______';
                else if (tipo === 'resta') opStr = ej.ops.join(' - ') + ' = ______';
                else if (tipo === 'multiplicacion') opStr = ej.ops.join(' √ó ') + ' = ______';
                else if (tipo === 'division') opStr = ej.ops[0] + ' √∑ ' + ej.ops[1] + ' = ______';
                
                contenido += `<div class="ejercicio"><span class="numero-ej">${i+1}</span>${opStr}</div>`;
            }
            contenido += `</div>`;
            contenido += `<div class="footer">MatePr√°ctica ¬∑ Ficha ${codigo}</div>`;
            contenido += `</div>`;
        }

        contenido += `</body></html>`;

        imprimirPDF(contenido);
    }

    function imprimirSoluciones() {
        const { tipo, ejercicios, codigo } = ejerciciosActuales;
        
        let contenido = `
            <html>
            <head>
                <title>Soluciones ${tipo} - C√≥digo ${codigo}</title>
                <style>
                    @page {
                        size: A4;
                        margin: 1.5cm;
                    }
                    body {
                        font-family: 'Courier New', monospace;
                        background: white;
                        padding: 30px;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        border-bottom: 2px solid #000;
                        padding-bottom: 15px;
                    }
                    .solucion {
                        border: 2px solid #000;
                        padding: 15px;
                        margin: 10px 0;
                        font-size: 18px;
                        background: #f9f9f9;
                    }
                    .codigo {
                        color: #666;
                        font-size: 14px;
                        margin-top: 5px;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 30px;
                        font-size: 12px;
                        color: #666;
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h2>üîç Soluciones ¬∑ ${tipo}</h2>
                    <div class="codigo">C√≥digo: ${codigo}</div>
                </div>
        `;

        ejercicios.forEach((ej, idx) => {
            let opStr = '';
            if (tipo === 'suma') opStr = ej.ops.join(' + ') + ' = ' + ej.resultado;
            else if (tipo === 'resta') opStr = ej.ops.join(' - ') + ' = ' + ej.resultado;
            else if (tipo === 'multiplicacion') opStr = ej.ops.join(' √ó ') + ' = ' + ej.resultado;
            else if (tipo === 'division') opStr = ej.ops[0] + ' √∑ ' + ej.ops[1] + ' = ' + ej.resultado;
            
            contenido += `<div class="solucion">${idx+1}. ${opStr}</div>`;
        });

        contenido += `
                <div class="footer">MatePr√°ctica ¬∑ Soluciones ${codigo}</div>
            </body>
            </html>
        `;

        imprimirPDF(contenido);
    }

    function imprimirPDF(contenido) {
        const ventana = window.open('', '_blank');
        ventana.document.write(contenido);
        ventana.document.close();
        ventana.focus();
        
        setTimeout(() => {
            ventana.print();
        }, 250);
    }
</script>
</body>
</html>